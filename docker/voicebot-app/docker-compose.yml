services:
  voicebot-app:
    build:
      context: ../../
      dockerfile: ./docker/voicebot-app/Dockerfile
    container_name: voicebot-app
    volumes:
      - ../../src:/app
      # PulseAudio socket (host -> container)
      - /mnt/wslg:/mnt/wslg
    environment:
      - PULSE_SERVER=unix:/mnt/wslg/PulseServer
      - LOG_LEVEL=${LOG_LEVEL:-info}
    command: [ "uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8001", "--reload", "--log-level", "${LOG_LEVEL:-info}" ]
    ports:
      - "8001:8001"
    # Environment variables are loaded from env_file in root docker-compose.yml
    stdin_open: true
    tty: true